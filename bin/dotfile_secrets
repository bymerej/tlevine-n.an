#!/bin/sh
set -e
TEMPLATES=~/.dotfiles

# Make sure the templates directory exists and contains files
[ -e "$TEMPLATES" ] && [ -z "`ls $TEMPLATES`" ] || exit 1

# Find variables id dotfiles
(
  cd "$TEMPLATES"
  pwd
  for dotfile in `ls -ab`; do
    echo "$dotfile"
    if [ "$dotfile" = '.' ] || [ "$dotfile" = '..' ]; then
      continue
    fi
    while true; do
      sed -n s/.*\({{[^}]}}\).*/\1/p "$dotfile"
      echo "$dotfile"
      break
    done
  done
)
